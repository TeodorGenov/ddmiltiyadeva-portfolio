{"version":3,"sources":["butter.js"],"names":["root","Butter","self","defaults","wrapperId","wrapperDamper","cancelOnTouch","validateOptions","ops","prop","hasOwnProperty","Object","defineProperty","value","getOwnPropertyDescriptor","wrapper","wrapperOffset","animateId","resizing","active","wrapperHeight","bodyHeight","prototype","init","options","document","getElementById","style","position","width","clientHeight","body","height","window","addEventListener","resize","bind","cancel","requestAnimationFrame","animate","wrapperUpdate","scrollY","scrollingElement","undefined","scrollTop","documentElement","transform","toFixed","checkResize","cancelAnimationFrame","setTimeout","parseInt","removeEventListener","removeAttribute","butter"],"mappings":"AAAA;AAEA,CAAC,UAASA,IAAT,EAAc;AACX,MAAIC,MAAM,GAAG,SAATA,MAAS,GAAW;AAEpB,QAAIC,IAAI,GAAG,IAAX;AAEA,SAAKC,QAAL,GAAgB;AACZC,MAAAA,SAAS,EAAE,QADC;AAEZC,MAAAA,aAAa,EAAE,IAFH;AAGZC,MAAAA,aAAa,EAAE;AAHH,KAAhB;;AAMA,SAAKC,eAAL,GAAuB,UAASC,GAAT,EAAc;AACjC,WAAK,IAAIC,IAAT,IAAiBD,GAAjB,EAAsB;AAClB,YAAIN,IAAI,CAACC,QAAL,CAAcO,cAAd,CAA6BD,IAA7B,CAAJ,EAAwC;AACpCE,UAAAA,MAAM,CAACC,cAAP,CAAsBV,IAAI,CAACC,QAA3B,EAAqCM,IAArC,EAA2C;AAACI,YAAAA,KAAK,EAAEF,MAAM,CAACG,wBAAP,CAAgCN,GAAhC,EAAqCC,IAArC,EAA2CI;AAAnD,WAA3C;AACH;AACJ;AACJ,KAND;;AAQA,SAAKR,aAAL;AACA,SAAKD,SAAL;AACA,SAAKE,aAAL;AACA,SAAKS,OAAL;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,SAAL;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKC,MAAL,GAAc,KAAd;AACA,SAAKC,aAAL;AACA,SAAKC,UAAL;AACH,GA5BD;;AA8BApB,EAAAA,MAAM,CAACqB,SAAP,GAAmB;AAEfC,IAAAA,IAAI,EAAE,cAASC,OAAT,EAAkB;AACpB,UAAIA,OAAJ,EAAa;AACT,aAAKjB,eAAL,CAAqBiB,OAArB;AACH;;AAED,WAAKL,MAAL,GAAc,IAAd;AACA,WAAKD,QAAL,GAAgB,KAAhB;AACA,WAAKb,aAAL,GAAqB,KAAKF,QAAL,CAAcE,aAAnC;AACA,WAAKD,SAAL,GAAiB,KAAKD,QAAL,CAAcC,SAA/B;AACA,WAAKE,aAAL,GAAqB,KAAKH,QAAL,CAAcG,aAAnC;AAEA,WAAKS,OAAL,GAAeU,QAAQ,CAACC,cAAT,CAAwB,KAAKtB,SAA7B,CAAf;AACA,WAAKW,OAAL,CAAaY,KAAb,CAAmBC,QAAnB,GAA8B,OAA9B;AACA,WAAKb,OAAL,CAAaY,KAAb,CAAmBE,KAAnB,GAA2B,MAA3B;AAEA,WAAKT,aAAL,GAAqB,KAAKL,OAAL,CAAae,YAAlC;AACAL,MAAAA,QAAQ,CAACM,IAAT,CAAcJ,KAAd,CAAoBK,MAApB,GAA6B,KAAKZ,aAAL,GAAqB,IAAlD;AAEAa,MAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAlC;;AACA,UAAI,KAAK9B,aAAT,EAAwB;AACpB2B,QAAAA,MAAM,CAACC,gBAAP,CAAwB,YAAxB,EAAsC,KAAKG,MAAL,CAAYD,IAAZ,CAAiB,IAAjB,CAAtC;AACH;;AACD,WAAKpB,aAAL,GAAqB,GAArB;AACA,WAAKC,SAAL,GAAiBgB,MAAM,CAACK,qBAAP,CAA6B,KAAKC,OAAL,CAAaH,IAAb,CAAkB,IAAlB,CAA7B,CAAjB,CAvBoB,CAyBpB;AACH,KA5Bc;AA8BfI,IAAAA,aAAa,EAAE,yBAAW;AACtB,UAAIC,OAAO,GAAIhB,QAAQ,CAACiB,gBAAT,IAA6BC,SAA9B,GAA2ClB,QAAQ,CAACiB,gBAAT,CAA0BE,SAArE,GAAkFnB,QAAQ,CAACoB,eAAT,CAAyBD,SAAzB,IAAsC,GAAtI;AACA,WAAK5B,aAAL,IAAsB,CAACyB,OAAO,GAAG,KAAKzB,aAAhB,IAAiC,KAAKX,aAA5D;AACA,WAAKU,OAAL,CAAaY,KAAb,CAAmBmB,SAAnB,GAA+B,mBAAoB,CAAC,KAAK9B,aAAL,CAAmB+B,OAAnB,CAA2B,CAA3B,CAArB,GAAsD,QAArF;AACH,KAlCc;AAoCfC,IAAAA,WAAW,EAAE,uBAAW;AACpB,UAAI,KAAK5B,aAAL,IAAsB,KAAKL,OAAL,CAAae,YAAvC,EAAqD;AACjD,aAAKK,MAAL;AACH;AACJ,KAxCc;AA0CfA,IAAAA,MAAM,EAAE,kBAAW;AACf,UAAIjC,IAAI,GAAG,IAAX;;AACA,UAAI,CAACA,IAAI,CAACgB,QAAV,EAAoB;AAChBhB,QAAAA,IAAI,CAACgB,QAAL,GAAgB,IAAhB;AACAe,QAAAA,MAAM,CAACgB,oBAAP,CAA4B/C,IAAI,CAACe,SAAjC;AACAgB,QAAAA,MAAM,CAACiB,UAAP,CAAkB,YAAW;AACzBhD,UAAAA,IAAI,CAACkB,aAAL,GAAqBlB,IAAI,CAACa,OAAL,CAAae,YAAlC;;AACA,cAAIqB,QAAQ,CAAC1B,QAAQ,CAACM,IAAT,CAAcJ,KAAd,CAAoBK,MAArB,CAAR,IAAwCmB,QAAQ,CAACjD,IAAI,CAACkB,aAAN,CAApD,EAA0E;AACtEK,YAAAA,QAAQ,CAACM,IAAT,CAAcJ,KAAd,CAAoBK,MAApB,GAA6B9B,IAAI,CAACkB,aAAL,GAAqB,IAAlD;AACH;;AACDlB,UAAAA,IAAI,CAACe,SAAL,GAAiBgB,MAAM,CAACK,qBAAP,CAA6BpC,IAAI,CAACqC,OAAL,CAAaH,IAAb,CAAkBlC,IAAlB,CAA7B,CAAjB;AACAA,UAAAA,IAAI,CAACgB,QAAL,GAAgB,KAAhB;AACH,SAPD,EAOG,GAPH;AAQH;AACJ,KAxDc;AA0DfqB,IAAAA,OAAO,EAAE,mBAAW;AAChB,WAAKS,WAAL;AACA,WAAKR,aAAL;AACA,WAAKvB,SAAL,GAAiBgB,MAAM,CAACK,qBAAP,CAA6B,KAAKC,OAAL,CAAaH,IAAb,CAAkB,IAAlB,CAA7B,CAAjB;AACH,KA9Dc;AAgEfC,IAAAA,MAAM,EAAE,kBAAW;AACf,UAAI,KAAKlB,MAAT,EAAiB;AACbc,QAAAA,MAAM,CAACgB,oBAAP,CAA4B,KAAKhC,SAAjC;AAEAgB,QAAAA,MAAM,CAACmB,mBAAP,CAA2B,QAA3B,EAAqC,KAAKjB,MAA1C;AACAF,QAAAA,MAAM,CAACmB,mBAAP,CAA2B,YAA3B,EAAyC,KAAKf,MAA9C;AACA,aAAKtB,OAAL,CAAasC,eAAb,CAA6B,OAA7B;AACA5B,QAAAA,QAAQ,CAACM,IAAT,CAAcsB,eAAd,CAA8B,OAA9B;AAEA,aAAKlC,MAAL,GAAc,KAAd;AACA,aAAKJ,OAAL,GAAe,EAAf;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,aAAKE,QAAL,GAAgB,IAAhB;AACA,aAAKD,SAAL,GAAiB,EAAjB;AACH;AACJ;AA/Ec,GAAnB;AAkFAjB,EAAAA,IAAI,CAACsD,MAAL,GAAc,IAAIrD,MAAJ,EAAd;AAEH,CAnHD,EAmHG,IAnHH","file":"butter.cd1ecf06.js","sourceRoot":"..\\src","sourcesContent":["// butter.js\n\n(function(root){\n    var Butter = function() {\n\n        var self = this;\n\n        this.defaults = {\n            wrapperId: 'butter',\n            wrapperDamper: 0.07,\n            cancelOnTouch: false\n        }\n        \n        this.validateOptions = function(ops) {\n            for (var prop in ops) {\n                if (self.defaults.hasOwnProperty(prop)) {\n                    Object.defineProperty(self.defaults, prop, {value: Object.getOwnPropertyDescriptor(ops, prop).value})\n                }\n            }\n        }\n\n        this.wrapperDamper;\n        this.wrapperId;\n        this.cancelOnTouch;\n        this.wrapper;\n        this.wrapperOffset = 0;\n        this.animateId;\n        this.resizing = false;\n        this.active = false;\n        this.wrapperHeight;\n        this.bodyHeight;\n    };\n\n    Butter.prototype = {\n\n        init: function(options) {\n            if (options) {\n                this.validateOptions(options);\n            }\n\n            this.active = true;\n            this.resizing = false;\n            this.wrapperDamper = this.defaults.wrapperDamper;\n            this.wrapperId = this.defaults.wrapperId;\n            this.cancelOnTouch = this.defaults.cancelOnTouch;\n\n            this.wrapper = document.getElementById(this.wrapperId);\n            this.wrapper.style.position = 'fixed';\n            this.wrapper.style.width = '100%';\n\n            this.wrapperHeight = this.wrapper.clientHeight;\n            document.body.style.height = this.wrapperHeight + 'px';\n\n            window.addEventListener('resize', this.resize.bind(this));\n            if (this.cancelOnTouch) {\n                window.addEventListener('touchstart', this.cancel.bind(this));\n            }\n            this.wrapperOffset = 0.0;\n            this.animateId = window.requestAnimationFrame(this.animate.bind(this));\n\n            // window.addEventListener('load', this.resize.bind(this));\n        },\n\n        wrapperUpdate: function() {\n            var scrollY = (document.scrollingElement != undefined) ? document.scrollingElement.scrollTop : (document.documentElement.scrollTop || 0.0);\n            this.wrapperOffset += (scrollY - this.wrapperOffset) * this.wrapperDamper;\n            this.wrapper.style.transform = 'translate3d(0,' + (-this.wrapperOffset.toFixed(2)) + 'px, 0)';\n        },\n\n        checkResize: function() {\n            if (this.wrapperHeight != this.wrapper.clientHeight) {\n                this.resize();\n            }\n        },\n\n        resize: function() {\n            var self = this;\n            if (!self.resizing) {\n                self.resizing = true;\n                window.cancelAnimationFrame(self.animateId);\n                window.setTimeout(function() {\n                    self.wrapperHeight = self.wrapper.clientHeight;\n                    if (parseInt(document.body.style.height) != parseInt(self.wrapperHeight)) {\n                        document.body.style.height = self.wrapperHeight + 'px';\n                    }\n                    self.animateId = window.requestAnimationFrame(self.animate.bind(self));\n                    self.resizing = false;\n                }, 150)\n            }\n        },\n\n        animate: function() {\n            this.checkResize();\n            this.wrapperUpdate();\n            this.animateId = window.requestAnimationFrame(this.animate.bind(this));\n        },\n\n        cancel: function() {\n            if (this.active) {\n                window.cancelAnimationFrame(this.animateId);\n\n                window.removeEventListener('resize', this.resize);\n                window.removeEventListener('touchstart', this.cancel);\n                this.wrapper.removeAttribute('style');\n                document.body.removeAttribute('style');\n\n                this.active = false;\n                this.wrapper = \"\";\n                this.wrapperOffset = 0;\n                this.resizing = true;\n                this.animateId = \"\";\n            }\n        },\n    };\n\n    root.butter = new Butter();\n\n})(this);"]}